(function(){var c=angular.G("dorfmap",[]);c.l("MapController",function(e,c,f){var d=this;d.p=decodeURIComponent((/[?|&]layer=([^&;]+?)(&|#|;|$)/.exec(location.search)||[,""])[1].replace(/\+/g,"%20"))||null||"control";d.b={};d.b.g=function(b){b.n=!0;c(function(){b.n=!1},300)};e.get("/ajax/menu.json").d(function(b){Object.keys(b).forEach(function(g){d.b[g]=b[g];f.B.v("update")});d.b.t.i=function(b){d.b.g(d.b.t);e.get("/action/"+b).d(function(){f.k("update")})};d.b.r.i=function(){d.b.g(d.b.r)};d.b.q.i=
function(b){d.b.g(d.b.q);d.p=b}})});c.l("OverviewController",function(e,c,f,d){var b=this;b.a={};this.update=function(){e.get("/list/all.json").d(function(c){Object.keys(c).forEach(function(a){b.a[a]?(b.a[a].status=c[a].status,b.a[a].type=c[a].type,b.a[a].c=c[a].c,b.a[a].statusText=c[a].statusText):(b.a[a]=c[a],b.a[a].f={},b.a[a].j=function(){return"light_au"===b.a[a].type},b.a[a].F=function(){if("dorfdoor"==a)return"/static/dorfdoor.png";statusName=1===b.a[a].status?"on":"off";return"hackcenter_blau"===
a?"/static/hackcenter_blau_"+statusName+".png":b.a[a].j()?(autoPrefix=0==b.a[a].e?"no":"",-1===b.a[a].status?"/static/light_"+autoPrefix+"auto.png":"/static/light_"+statusName+"_"+autoPrefix+"auto.png"):-1===b.a[a].status?"/static/"+b.a[a].type+".png":"/static/"+b.a[a].type+"_"+statusName+".png"},b.a[a].toggle=function(){b.a[a].o&&0>=b.a[a].c&&("blinkenlight"==b.a[a].type?window.location.href="/blinkencontrol/"+a:"charwrite"==b.a[a].type?window.location.href="/charwrite/"+a:e.get("/ajax/rate_limit/"+
b.a[a].name+".json").d(function(c){0<parseInt(c)&&0===b.a[a].status?(b.a[a].H=b.a[a].statusText,delete b.a[a].f.cursor,b.a[a].c=c,d(function(){0==--b.a[a].c&&(b.a[a].f.cursor="pointer")},1E3,b.a[a].c)):e.get("/toggle/"+a).d(function(){e.get("/ajax/statustext/infoarea").d(function(a){b.a.infoarea.statusText=f.h(a)});b.a[a].j()?e.get("/get/"+a+".json").d(function(c){b.a[a].status=parseInt(c.status);b.a[a].e=c.e;c=b.a[a].statusText.toString();1==b.a[a].e&&-1!=c.indexOf("(deaktiviert)")?b.a[a].statusText=
f.h(c.replace(" (deaktiviert)","")):0==b.a[a].e&&-1==c.indexOf("(deaktiviert)")&&(b.a[a].statusText=f.h(c+" (deaktiviert)"))}):0<=b.a[a].status?b.a[a].status=++b.a[a].status%2:e.get("/get/"+b.a[a].name+".json").d(function(c){c.status||(c.status=0);b.a[a].status=parseInt(c.status);b.a[a].e=c.e})})}))},b.a[a].J=function(){if("infoarea"!=b.a[a].type&&"rtext"!=b.a[a].type)return"popup"},b.a[a].C=function(){return"dorfdoor"===a?0===b.a[a].status?"closed":"open":"rtext"===b.a[a].type?"rtext":""});"string"==
typeof b.a[a].statusText&&(b.a[a].statusText=f.h(b.a[a].statusText.split(" (rate")[0]));b.a[a].o&&(0<b.a[a].c?d(function(){0==--b.a[a].c&&(b.a[a].f.cursor="pointer")},1E3,b.a[a].I):b.a[a].f.cursor="pointer");b.a[a].status||(b.a[a].status=0);b.a[a].status=parseInt(b.a[a].status)})})};c.A.w("update",b.update);c.k("update");d(this.update,2E4)});c.m("lamp",function(){return{s:"E",u:"/templates/lamp-template.html"}});c.m("dropdownmenu",function(){return{s:"E",u:"/templates/dropdownmenu-template.html",
scope:{action:"=",D:"=",data:"="}}})})();